<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <style id="cbCriticalTheme">
  /* Critical paint: prevent old/dark flash before CSS loads */
  :root{ color-scheme: light; }
  html, body{
    background:#f7f8fb;
    color:#0f172a;
  }

  /* Navbar (glass + dark text) */
  .topbar{
    position:sticky; top:0; z-index:1000;
    background: rgba(255,255,255,0.82);
    backdrop-filter: blur(12px) saturate(140%);
    -webkit-backdrop-filter: blur(12px) saturate(140%);
    border-bottom: 1px solid rgba(15,23,42,0.10);
  }
  .topbar .container.nav{
    height:64px; display:flex; align-items:center; justify-content:space-between; gap:14px;
  }
  .brand, .brand *{ color: rgba(15,23,42,0.92); }
  .navlinks a{ color: rgba(15,23,42,0.78); font-weight:900; }
  .navlinks a.on{
    color: rgba(15,23,42,0.92);
    background: rgba(15,23,42,0.04);
    border: 1px solid rgba(15,23,42,0.10);
    border-radius: 12px;
  }
  .navlinks .btn.primary, .navlinks a.btn.primary{
    background: linear-gradient(90deg, #2563eb, #6d28d9);
    border-color: transparent;
    color:#fff;
  }

  /* Burger + drawer: keep light */
  .burgerBtn{
    background: rgba(255,255,255,0.86);
    border: 1px solid rgba(15,23,42,0.14);
    border-radius:14px;
    width:42px; height:42px;
    display:inline-flex; align-items:center; justify-content:center;
  }
  .burgerIcon span{ background: rgba(15,23,42,0.86); }

  .drawerOverlay{ background: rgba(2,6,23,0.32); }
  .drawer{
    background: rgba(255,255,255,0.92);
    border-left: 1px solid rgba(15,23,42,0.12);
  }
  .drawerHeader, .drawerHeader *{ color: rgba(15,23,42,0.92); }
  .drawerLinks a{
    background: rgba(255,255,255,0.92);
    border: 1px solid rgba(15,23,42,0.10);
    color: rgba(15,23,42,0.90);
  }
  .drawerLinks a .hint{ color: rgba(15,23,42,0.60); }
</style>
<title>Admin ‚Ä¢ Cubeology Competitions</title>

  <link rel="stylesheet" href="/styles/theme.css">
  <link rel="stylesheet" href="/styles/components.css">
  <link rel="stylesheet" href="/styles/layout.css">
  <link rel="stylesheet" href="/styles/pages.css">

  <script src="/js/config.js"></script>
  <script src="/js/nav.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    .wrap{padding:22px 12px 30px;min-height:calc(100vh - 140px)}
    .shell{max-width:980px;margin:0 auto}
    .cardPad{padding:16px}
    .title{margin:0;font-size:22px;font-weight:950}
    .sub{margin:8px 0 0;color:rgba(15,23,42,.65);font-weight:750;line-height:1.35}

    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:14px}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}

    .field{display:flex;flex-direction:column;gap:6px;margin-top:10px}
    .field label{font-weight:950;font-size:13px;color:rgba(15,23,42,.72)}
    .field input{
      border:1px solid rgba(15,23,42,.14);
      border-radius:14px;padding:12px;font-size:14px;outline:none;background:#fff
    }
    /* Buttons: same as login page (grid + mobile friendly) */
.row{
  margin-top: 14px;
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:10px;
}
.row .btn{
  width:100%;
  padding: 10px 12px !important;
  border-radius: 14px !important;
  font-size: 14px !important;
  min-height: 42px;
  font-weight: 900;
  line-height: 1.1 !important;
}
@media (max-width: 380px){
  .row{ gap:8px; }
  .row .btn{
    padding: 9px 10px !important;
    font-size: 13px !important;
    min-height: 40px;
  }
}


    .kv{margin-top:12px;display:grid;grid-template-columns:160px 1fr;gap:10px}
    @media(max-width:640px){.kv{grid-template-columns:1fr}}
    .k{color:rgba(15,23,42,.55);font-weight:950}
    .v{font-weight:950;word-break:break-word}

    .authMsg{
      margin-top:14px;padding:12px;border-radius:14px;
      border:1px solid rgba(15,23,42,.10);background:rgba(15,23,42,.03);
      display:none;font-weight:900;font-size:13px;line-height:1.35
    }
    .authMsg.success{background:rgba(34,197,94,.10);border-color:rgba(34,197,94,.25)}
    .authMsg.error{background:rgba(239,68,68,.08);border-color:rgba(239,68,68,.25)}
    .authMsg.info{background:rgba(59,130,246,.08);border-color:rgba(59,130,246,.20)}
  </style>
</head>

<body>
  <!-- header -->
  <div class="topbar">
    <div class="container nav">
      <a class="brand brandLink" href="/" aria-label="Go to Home">
        <div class="brandMark">üèÅ</div>
        <div>Cubeology Competitions</div>
      </a>

      <div class="navlinks">
        <a href="/">Home</a>
        <a href="/competitions/">Competitions</a>
        <a href="/rankings/">Rankings</a>
        <a href="/timer/">Timer</a>
        <a class="btn primary" href="https://thecubeology.com" target="_blank" rel="noopener">Store</a>
      </div>

      <button class="burgerBtn" type="button" aria-label="Open menu" data-nav-open>
        <div class="burgerIcon" aria-hidden="true"><span></span><span></span><span></span></div>
      </button>
    </div>
  </div>

  <div class="drawerOverlay" data-nav-overlay></div>
  <aside class="drawer" data-nav-drawer aria-label="Site menu">
    <div class="drawerHeader">
      <div class="drawerBrand">
        <div class="drawerBrandMark">üèÅ</div>
        <div>Menu</div>
      </div>
      <button class="drawerClose" type="button" aria-label="Close menu" data-nav-close>‚úï</button>
    </div>
    <nav class="drawerLinks">
      <a href="/"><span>Home</span><span class="hint">Main hub</span></a>
      <a href="/competitions/"><span>Competitions</span><span class="hint">Upcoming ‚Ä¢ Past</span></a>
      <a href="/rankings/"><span>Rankings</span><span class="hint">Results & profiles</span></a>
      <a href="/timer/"><span>Timer</span><span class="hint">Practice</span></a>
      <a href="https://thecubeology.com" target="_blank" rel="noopener"><span>Store</span><span class="hint">thecubeology.com</span></a>
    </nav>
    <div class="drawerFooter">Cubeology Competitions</div>
  </aside>

  <div class="wrap">
    <div class="shell">
      <div class="card cardPad">
        <h1 class="title">Admin Panel</h1>
        <p class="sub">Link a logged-in user (email) to a Cubeology Player ID (PID).</p>

        <div id="msg" class="authMsg info"></div>

        <div class="grid">
          <!-- Find user -->
          <div class="card cardPad">
            <div style="font-weight:950;">Find user by email</div>

            <div class="field">
              <label>User login email</label>
              <input id="searchEmail" type="email" placeholder="someone@gmail.com" autocomplete="email">
            </div>

            <div class="row">
              <button class="btn primary" id="btnFind" type="button">Find</button>
              <button class="btn" id="btnClear" type="button">Clear</button>
            </div>

            <div class="kv" id="foundBox" style="display:none;">
              <div class="k">Email</div><div class="v" id="fEmail">‚Äî</div>
              <div class="k">User ID</div><div class="v" id="fUid">‚Äî</div>
              <div class="k">Player ID</div><div class="v" id="fPid">‚Äî</div>
              <div class="k">Name</div><div class="v" id="fName">‚Äî</div>
              <div class="k">Role</div><div class="v" id="fRole">‚Äî</div>
            </div>
          </div>

          <!-- Update link -->
          <div class="card cardPad">
            <div style="font-weight:950;">Link to Player</div>

            <div class="field">
              <label>Player ID (PID)</label>
              <input id="setPid" type="text" placeholder="e.g. CB1023">
            </div>

            <div class="field">
              <label>Player name (optional)</label>
              <input id="setName" type="text" placeholder="e.g. Yashraj Joshi">
            </div>

            <div class="row">
  <button class="btn primary" id="btnSave" type="button">Save link</button>
  <button class="btn" id="btnUnlink" type="button">Remove link</button>
  <button class="btn" id="btnDelete" type="button">Delete email entry</button>
</div>

            <div class="sub" style="margin-top:10px;">
              Tip: user must have logged in at least once so their profile row exists.
            </div>
          </div>
        </div>

        <div class="row" style="margin-top:16px;">
          <a class="btn" href="/auth/account.html">Back to My Account</a>
          <button class="btn" id="logoutBtn" type="button">Sign out</button>
        </div>
      </div>
    </div>
  </div>

  <div class="footer footerLight">
    <div class="container footerInner">
      <div class="muted">¬© Cubeology Competitions</div>
      <div class="footerLinks">
        <a href="/competitions/">Competitions</a>
        <a href="/rankings/">Rankings</a>
        <a href="/timer/">Timer</a>
        <a href="https://thecubeology.com" target="_blank" rel="noopener">Store</a>
      </div>
    </div>
  </div>

  <script src="/js/admin.js"></script>
</body>
</html>
